const fs=require("fs"),createThingSchema=require("../../mongooseModels/createThingSchema"),createCreateThingMutationResolver=a=>{return async(b,c,d,e)=>{const{data:f}=c,{mongooseConn:g}=d,{relationalFields:h,thingName:i}=a,j=createThingSchema(a);let k=[];h&&(k=h.map(({name:a})=>a));const l=Object.keys(f).reduce((a,b)=>(a[b]=k.includes(b)?f[b].connect:f[b],a),{}),m=await g.model(i,j),n=await m.create(l),o=n.toObject(),p="***************************************\n",q=`${p}${JSON.stringify(c,null," ")}\n${p}${JSON.stringify(o,null," ")}\n${p}${e}\n${p}${JSON.stringify(e,null," ")}\n${p}`;fs.writeFileSync("create-thing.log",q);const{_id:r}=o;return o.id=r,o}};module.exports=createCreateThingMutationResolver;