const createThingSchema=require("../../mongooseModels/createThingSchema"),processDeleteData=require("./processDeleteData"),createDeleteThingMutationResolver=(a,b)=>{const{enums:c}=b;return async(b,d,e)=>{const{where:f}=d,{mongooseConn:g}=e,{name:h}=a,i=createThingSchema(a,c),j=g.model(h,i),k=Object.keys(f);if(1!==k.length)throw new TypeError("Expected exactly one key in where arg!");const l=f.id?{_id:f.id}:f,m=await j.findOne(l,null,{lean:!0});if(!m)return null;const{_id:n}=m;await j.findOneAndDelete({_id:n});const o=[],p=processDeleteData(m,a);return p.forEach((a,b)=>{const{name:d}=b,e=createThingSchema(b,c),f=g.model(d,e);o.push(f.bulkWrite(a))}),await Promise.all(o),m.id=n,m}};module.exports=createDeleteThingMutationResolver;